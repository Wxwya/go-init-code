import{b as w,ak as B,r as i,G as k,F as P,o as u,q as c,g as y,ah as T,u as g,W as E,Z as H,$ as M,f as Y,e as S}from"../.pnpm/.pnpm.Bbu8tIZm.js";import{_ as $}from"../_plugin-vue_export-helper/_plugin-vue_export-helper.DlAUqK2U.js";const b={class:"w-full h-[200px] bg-white overflow-hidden"},F={key:0,class:"text-center"},z={key:1,class:"text-center"},o=50,D=w({__name:"index",props:{load:{type:Function,default:()=>{}},refresh:{type:Function,default:()=>{}},loading:{type:Boolean,default:!1},list:{type:Array,default:()=>[]},finished:{type:Boolean,default:!0}},setup(d){const f=[" ","下拉即可刷新","释放即可刷新","重新加载中..."],s=d,e=B({isPull:!0,status:0,headHeight:o,startY:0}),a=i(null),t=i(null),p=i(null),m=l=>{e.isPull&&(e.startY=l.changedTouches[0].clientY)},h=async l=>{e.isPull&&(e.startY=l.changedTouches[0].clientY-e.startY,e.startY-.5*o>=o?(e.status=3,a.value.style.top="0px",a.value.style.transform="translateY(0px)",t.value.style.transform="translateY(50px)",await s.refresh(),t.value.style.transform="translateY(0px)",a.value.style.top=""):(t.value.style.transform="translateY(0px)",a.value.style.transform="translateY(0px)"))},_=l=>{if(!e.isPull)return;const r=l.changedTouches[0].clientY-e.startY;let v=r;r>1.5*o?(e.status=2,v=r>3*o?3*o:r):e.status=1,a.value.style.transform=`translateY(${v}px)`,t.value.style.transform=`translateY(${v}px)`},n=()=>{if(e.isPull=!(t.value.scrollTop>0),t.value.scrollTop+t.value.clientHeight>=t.value.scrollHeight&&s.finished){if(p.value)return;p.value=setTimeout(async()=>{await s.load(),p.value=null},100)}};return k(()=>{t.value.addEventListener("scroll",n),s.load()}),P(()=>{t.value.removeEventListener("scroll",n)}),(l,r)=>(u(),c("div",b,[y("div",{ref_key:"pullBox",ref:a,class:"text-center relative left-0 top-[-50px] bg-slate-300",style:E({height:o+"px",lineHeight:o+"px",transition:"all 0.3s linear"})},T(f[g(e).status]),5),y("div",{ref_key:"mainBox",ref:t,onTouchstartPassive:m,onTouchend:h,onTouchmove:_,onTouchcancel:h,style:{transition:"all 0.3s linear"},class:"relative left-0 top-[-50px] h-full bg-white overflow-y-auto"},[(u(!0),c(H,null,M(d.list,(v,x)=>(u(),c("div",{class:"",key:x},T(x),1))),128)),d.loading?(u(),c("div",F,"加载中...")):Y("",!0),d.finished?Y("",!0):(u(),c("div",z,"没有更多了..."))],544)]))}}),L=$(D,[["__scopeId","data-v-119c7d85"]]),q={class:"p-4"},A=y("a",{href:"https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzI4MTU5MjgwMQ==&scene=110#wechat_redirect​"},"12312",-1),U=w({__name:"index",setup(d){const f=B({pagenum:1,pagesize:10}),s=i(1),e=i([]),a=i(!0),t=i(!0),p=()=>new Promise((n,l)=>{setTimeout(()=>{n({code:200,data:[{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"},{name:"张三",age:18,address:"北京"}],total:40})},2e3)}),m=async()=>{const n=await p();f.pagenum==1&&(e.value=[]),e.value=[...e.value,...n.data],s.value=n.total,a.value=!1},h=async()=>{a.value=!0,await m(),f.pagenum++,e.value.length>=s.value&&(t.value=!1,a.value=!1)},_=async()=>{f.pagenum=1,s.value=1,t.value=!0,await m()};return(n,l)=>{const r=L;return u(),c("div",q,[S(r,{loading:g(a),load:h,list:g(e),finished:g(t),refresh:_},null,8,["loading","list","finished"]),A])}}});export{U as default};
